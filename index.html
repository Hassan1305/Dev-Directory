<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Developers Directory - Find Software Houses in Pakistan</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />
    <style>
      .company-card {
        transition: transform 0.2s, box-shadow 0.2s;
      }
      .company-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }
      .hero-pattern {
        background-color: #075e54;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.12'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      }
      .modal {
        transition: opacity 0.25s ease;
      }
      .modal-active {
        overflow-y: visible !important;
      }
      .location-tag {
        transition: all 0.2s;
      }
      .location-tag:hover {
        background-color: #047857;
      }

      /* Fix for search text visibility */
      #search-input::placeholder {
        color: #9ca3af;
      }

      #search-input {
        color: #111827;
      }

      #city-filter,
      #items-per-page {
        color: #111827; /* Dark text color for better visibility */
        background-color: #ffffff; /* White background */
      }

      #city-filter option,
      #items-per-page option {
        color: #111827; /* Ensure dropdown options are visible */
        background-color: #ffffff; /* White background for options */
      }

      /* Fix for dropdown focus states */
      #city-filter:focus,
      #items-per-page:focus {
        border-color: #10b981; /* Green border when focused (matches the site theme) */
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2); /* Subtle green glow */
        outline: none;
      }

      /* Load more button pulse animation */
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.7;
        }
      }

      .pulse {
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-md">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
          <div class="flex">
            <div class="flex-shrink-0 flex items-center">
              <span class="text-2xl font-bold text-green-600"
                >Developers Directory</span
              >
            </div>
            <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
              <a
                href="index.html"
                class="border-green-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
              >
                Directory
              </a>
              <a
                href="about.html"
                class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
              >
                About Us
              </a>
            </div>
          </div>
          <div class="-mr-2 flex items-center sm:hidden">
            <button
              id="mobile-menu-button"
              class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-green-500"
            >
              <span class="sr-only">Open main menu</span>
              <svg
                class="h-6 w-6"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Mobile menu, show/hide based on menu state -->
      <div id="mobile-menu" class="sm:hidden hidden">
        <div class="pt-2 pb-3 space-y-1">
          <a
            href="index.html"
            class="bg-green-50 border-green-500 text-green-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium"
          >
            Directory
          </a>
          <a
            href="about.html"
            class="border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium"
          >
            About Us
          </a>
          <a
            href="https://github.com/Hassan1305/Developers-Directory"
            target="_blank"
            class="border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium"
          >
            <i class="fab fa-github mr-1"></i> GitHub
          </a>
        </div>
      </div>
    </nav>

    <!-- Hero section -->
    <div class="hero-pattern text-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-20">
        <h1 class="text-3xl md:text-4xl font-bold mb-4">
          Find Software Houses in Pakistan
        </h1>
        <p class="text-xl opacity-90 mb-8 max-w-3xl">
          The most comprehensive open-source directory of software companies in
          Pakistan for job seekers, freelancers, and students.
        </p>

        <!-- Search and filter -->
        <div class="bg-white p-4 rounded-lg shadow-md max-w-4xl">
          <div class="md:flex space-y-4 md:space-y-0 md:space-x-4">
            <div class="relative md:flex-1">
              <div
                class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
              >
                <i class="fas fa-search text-gray-400"></i>
              </div>
              <input
                id="search-input"
                type="text"
                class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-green-500 focus:border-green-500 sm:text-sm"
                placeholder="Search by company name or email..."
              />
            </div>
            <div class="md:w-1/5">
              <select
                id="city-filter"
                class="block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md"
              >
                <option value="">All Cities</option>
                <!-- Cities will be populated from data.json -->
              </select>
            </div>
            <div class="md:w-1/5">
              <select
                id="items-per-page"
                class="block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md"
              >
                <option value="10">10 per page</option>
                <option value="15" selected>15 per page</option>
                <option value="25">25 per page</option>
                <option value="50">50 per page</option>
                <option value="100">100 per page</option>
              </select>
            </div>
          </div>
          <div class="mt-2 flex justify-between items-center">
            <div class="text-sm text-gray-500">
              <label for="items-per-page" class="font-medium">Display: </label>
              <span id="display-info" class="text-xs"
                >15 companies per page</span
              >
            </div>
            <span id="results-count" class="text-sm text-gray-600">
              Showing all companies
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Company directory -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div id="loading" class="text-center py-10">
        <div
          class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"
        ></div>
        <p class="mt-2 text-gray-600">Loading software houses...</p>
      </div>

      <div
        id="companies-container"
        class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
      >
        <!-- Companies will be populated here from data.json -->
      </div>

      <!-- Load More Button -->
      <div id="load-more-container" class="hidden text-center py-8">
        <button
          id="load-more-btn"
          class="px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-all shadow-md hover:shadow-lg"
        >
          Load More <i class="fas fa-chevron-down ml-2"></i>
        </button>
      </div>

      <div id="no-results" class="hidden text-center py-10">
        <div class="text-gray-400 mb-4">
          <i class="fas fa-search fa-3x"></i>
        </div>
        <h3 class="text-xl font-semibold text-gray-700">No companies found</h3>
        <p class="text-gray-500 mt-2">Try adjusting your search or filter</p>
      </div>
    </div>

    <!-- Company Description Modal -->
    <div
      id="modal-container"
      class="hidden fixed inset-0 z-50 flex items-center justify-center"
    >
      <div class="modal-overlay absolute inset-0 bg-black opacity-50"></div>
      <div
        class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto max-h-full"
      >
        <!-- Modal Content -->
        <div class="modal-content py-4 text-left px-6">
          <!-- Modal Header -->
          <div class="flex justify-between items-center pb-3">
            <p id="modal-title" class="text-xl font-bold text-gray-900"></p>
            <button
              id="modal-close"
              class="modal-close cursor-pointer z-50 text-gray-500 hover:text-gray-800"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <!-- Modal Body -->
          <div id="modal-body" class="text-gray-600"></div>
          <!-- Modal Footer -->
          <div class="pt-4 flex justify-end">
            <button
              id="modal-ok"
              class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-8">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="md:flex md:justify-between">
          <div class="mb-6 md:mb-0">
            <h2 class="text-xl font-bold">Developers Directory</h2>
            <p class="mt-2 text-gray-300 text-sm">
              An open-source directory of software houses in Pakistan.
            </p>
          </div>
          <div>
            <h3 class="text-sm font-semibold uppercase tracking-wider">
              Links
            </h3>
            <div class="mt-4 space-y-2">
              <a href="index.html" class="text-gray-300 hover:text-white block"
                >Home</a
              >
              <a href="about.html" class="text-gray-300 hover:text-white block"
                >About Us</a
              >
              <a
                href="https://github.com/Hassan1305/Developers-Directory"
                target="_blank"
                class="text-gray-300 hover:text-white block"
              >
                <i class="fab fa-github mr-1"></i> GitHub
              </a>
            </div>
          </div>
        </div>
        <div
          class="mt-8 border-t border-gray-700 pt-6 flex flex-col md:flex-row justify-between"
        >
          <p class="text-gray-300 text-sm">
            &copy; 2025 Developers Directory. All rights reserved.
          </p>
          <p class="text-gray-300 text-sm mt-2 md:mt-0">
            Made with <span class="text-red-500">❤</span> for the Pakistani dev
            community
          </p>
        </div>
      </div>
    </footer>

    <script>
      // Pagination variables
      let currentPage = 1;
      let itemsPerPage = 15; // Default value
      let isLoading = false;

      // Core data variables
      let allCompanies = [];
      let filteredCompanies = [];

      // Mobile menu toggle
      document
        .getElementById("mobile-menu-button")
        .addEventListener("click", function () {
          const menu = document.getElementById("mobile-menu");
          menu.classList.toggle("hidden");
        });

      // Modal functionality
      const modalContainer = document.getElementById("modal-container");
      const modalTitle = document.getElementById("modal-title");
      const modalBody = document.getElementById("modal-body");
      const modalClose = document.getElementById("modal-close");
      const modalOk = document.getElementById("modal-ok");

      // Function to handle changing items per page
      function changeItemsPerPage() {
        // Get the selected value
        const newItemsPerPage = parseInt(
          document.getElementById("items-per-page").value
        );

        // If it hasn't changed, do nothing
        if (newItemsPerPage === itemsPerPage) return;

        // Update the items per page
        itemsPerPage = newItemsPerPage;

        // Update the display info
        document.getElementById(
          "display-info"
        ).textContent = `${itemsPerPage} companies per page`;

        // Reset to page 1 and redisplay
        currentPage = 1;
        displayCompanies(filteredCompanies);
        updateResultsCount();

        // Show load more button if needed
        const loadMoreContainer = document.getElementById(
          "load-more-container"
        );
        if (filteredCompanies.length > itemsPerPage) {
          loadMoreContainer.classList.remove("hidden");
        } else {
          loadMoreContainer.classList.add("hidden");
        }

        // Save preference to localStorage
        localStorage.setItem("devdir-itemsPerPage", itemsPerPage);
      }

      // Function to load saved preferences
      function loadSavedPreferences() {
        // Load items per page preference
        const savedItemsPerPage = localStorage.getItem("devdir-itemsPerPage");
        if (savedItemsPerPage) {
          itemsPerPage = parseInt(savedItemsPerPage);

          // Set the dropdown to match
          const itemsPerPageSelect = document.getElementById("items-per-page");
          for (let i = 0; i < itemsPerPageSelect.options.length; i++) {
            if (
              parseInt(itemsPerPageSelect.options[i].value) === itemsPerPage
            ) {
              itemsPerPageSelect.selectedIndex = i;
              break;
            }
          }

          // Update display info
          document.getElementById(
            "display-info"
          ).textContent = `${itemsPerPage} companies per page`;
        }
      }

      function openModal(companyName, companyData) {
        // Set the modal title
        modalTitle.textContent = companyName;

        // Get the company object
        const company = allCompanies.find((c) => c.name === companyName);

        if (!company) {
          modalBody.innerHTML = companyData; // Fallback to just showing description
          modalContainer.classList.remove("hidden");
          document.body.classList.add("modal-active");
          return;
        }

        // Build a more comprehensive modal content
        let modalContent = `
    <div class="space-y-4">
  `;

        // Add business type if available
        if (company.businessType) {
          let typeColor = "";
          let typeIcon = "";
          let typeDescription = "";

          if (company.businessType === "Service-based") {
            typeColor = "text-blue-600";
            typeIcon = "fa-hands-helping";
            typeDescription = "Offers services to clients";
          } else if (company.businessType === "Product-based") {
            typeColor = "text-green-600";
            typeIcon = "fa-box";
            typeDescription = "Develops and sells products";
          } else if (company.businessType === "Hybrid") {
            typeColor = "text-purple-600";
            typeIcon = "fa-boxes";
            typeDescription = "Offers both products and services";
          } else {
            typeColor = "text-gray-600";
            typeIcon = "fa-building";
            typeDescription = company.businessType;
          }

          modalContent += `
      <div class="flex items-center mb-2">
        <span class="inline-flex items-center px-2.5 py-1 rounded-full text-sm font-medium ${typeColor} bg-gray-100">
          <i class="fas ${typeIcon} mr-2"></i> ${company.businessType}
        </span>
        <span class="text-gray-500 text-sm ml-2">${typeDescription}</span>
      </div>
    `;
        }

        // Add description
        modalContent += `
    <div>
      <p class="text-gray-700">${company.description}</p>
    </div>
  `;
        // Add website if available
        if (company.website) {
          modalContent += `
      <div>
        <h4 class="text-sm font-medium text-gray-900">Website</h4>
        <a href="${company.website}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800 flex items-center">
          ${company.website}
          <i class="fas fa-external-link-alt text-xs ml-1"></i>
        </a>
      </div>
    `;
        }

        // Business offerings section (products and services)
        let hasOfferings =
          (company.services && company.services.length > 0) ||
          (company.products && company.products.length > 0);

        if (hasOfferings) {
          modalContent += `
      <div class="border-t border-gray-200 pt-4">
        <h4 class="text-md font-semibold text-gray-900 mb-3">Offerings</h4>
    `;

          // Add services if available
          if (
            company.services &&
            Array.isArray(company.services) &&
            company.services.length > 0
          ) {
            modalContent += `
        <div class="mb-3">
          <h5 class="text-sm font-medium text-gray-900">Services</h5>
          <div class="flex flex-wrap gap-1 mt-1">
      `;

            company.services.forEach((service) => {
              modalContent += `
          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800">
            <i class="fas fa-cogs mr-1"></i> ${service}
          </span>
        `;
            });

            modalContent += `</div></div>`;
          }

          // Add products if available
          if (
            company.products &&
            Array.isArray(company.products) &&
            company.products.length > 0
          ) {
            modalContent += `
        <div>
          <h5 class="text-sm font-medium text-gray-900">Products</h5>
          <div class="flex flex-wrap gap-1 mt-1">
      `;

            company.products.forEach((product) => {
              modalContent += `
          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800">
            <i class="fas fa-box-open mr-1"></i> ${product}
          </span>
        `;
            });

            modalContent += `</div></div>`;
          }

          modalContent += `</div>`;
        }

        // Add tech stack if available
        if (
          company.techStack &&
          Array.isArray(company.techStack) &&
          company.techStack.length > 0
        ) {
          modalContent += `
      <div>
        <h4 class="text-sm font-medium text-gray-900">Technology Stack</h4>
        <div class="flex flex-wrap gap-1 mt-1">
    `;

          company.techStack.forEach((tech) => {
            modalContent += `
        <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800">
          <i class="fas fa-code mr-1"></i> ${tech}
        </span>
      `;
          });

          modalContent += `</div></div>`;
        }

        // Add locations
        if (company.locations && company.locations.length > 0) {
          modalContent += `
      <div class="border-t border-gray-200 pt-4">
        <h4 class="text-md font-semibold text-gray-900 mb-2">Locations</h4>
        <ul class="mt-1 space-y-3">
    `;

          company.locations.forEach((location) => {
            modalContent += `
        <li class="text-sm text-gray-700">
          <div class="flex items-start">
            <i class="fas fa-map-marker-alt text-gray-400 mt-0.5 mr-2"></i>
            <div>
              <span class="font-medium">${location.city}</span>${
              location.isHeadquarters
                ? ' <span class="text-green-600 font-medium">(Headquarters)</span>'
                : ""
            }
              ${
                location.address
                  ? `<div class="mt-1">${location.address}</div>`
                  : ""
              }
              ${
                location.mapLink
                  ? `<a href="${location.mapLink}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:text-blue-800 inline-flex items-center mt-1">
                <i class="fas fa-directions mr-1"></i> View on Map
              </a>`
                  : ""
              }
            </div>
          </div>
        </li>
      `;
          });

          modalContent += `</ul></div>`;
        }

        // Add contact section
        modalContent += `
    <div class="border-t border-gray-200 pt-4">
      <h4 class="text-md font-semibold text-gray-900 mb-2">Contact</h4>
      <p class="flex items-center text-sm">
        <i class="fas fa-envelope text-gray-400 mr-2"></i>
        <a href="mailto:${company.email}" class="text-blue-600 hover:text-blue-800">${company.email}</a>
      </p>
  `;

        // Add social links if available
        const hasSocialLinks =
          company.socialLinks &&
          (company.socialLinks.linkedin ||
            company.socialLinks.github ||
            company.socialLinks.facebook ||
            company.socialLinks.instagram ||
            company.socialLinks.careers);

        if (hasSocialLinks) {
          modalContent += `
      <div class="mt-3">
        <p class="text-sm text-gray-500 mb-2">Connect:</p>
        <div class="flex flex-wrap gap-3">
    `;

          if (company.socialLinks.linkedin) {
            modalContent += `
        <a href="${company.socialLinks.linkedin}" target="_blank" rel="noopener noreferrer" class="text-[#0077b5] hover:opacity-80 inline-flex items-center">
          <i class="fab fa-linkedin fa-lg mr-1"></i>
          <span class="text-sm">LinkedIn</span>
        </a>
      `;
          }

          if (company.socialLinks.github) {
            modalContent += `
        <a href="${company.socialLinks.github}" target="_blank" rel="noopener noreferrer" class="text-[#333333] hover:opacity-80 inline-flex items-center">
          <i class="fab fa-github fa-lg mr-1"></i>
          <span class="text-sm">GitHub</span>
        </a>
      `;
          }

          if (company.socialLinks.facebook) {
            modalContent += `
        <a href="${company.socialLinks.facebook}" target="_blank" rel="noopener noreferrer" class="text-[#1877f2] hover:opacity-80 inline-flex items-center">
          <i class="fab fa-facebook-square fa-lg mr-1"></i>
          <span class="text-sm">Facebook</span>
        </a>
      `;
          }

          if (company.socialLinks.instagram) {
            modalContent += `
        <a href="${company.socialLinks.instagram}" target="_blank" rel="noopener noreferrer" class="text-[#e1306c] hover:opacity-80 inline-flex items-center">
          <i class="fab fa-instagram fa-lg mr-1"></i>
          <span class="text-sm">Instagram</span>
        </a>
      `;
          }

          if (company.socialLinks.careers) {
            modalContent += `
        <a href="${company.socialLinks.careers}" target="_blank" rel="noopener noreferrer" class="text-[#28a745] hover:opacity-80 inline-flex items-center">
          <i class="fas fa-briefcase fa-lg mr-1"></i>
          <span class="text-sm">Careers</span>
        </a>
      `;
          }

          modalContent += `</div></div>`;
        }

        modalContent += `</div>`;

        // Add hiring status if available
        if (company.hiringStatus) {
          const hiringStatus = company.hiringStatus.toLowerCase();
          let statusColor = "";
          let statusIcon = "";
          let statusText = "";

          if (hiringStatus === "active") {
            statusColor = "text-green-600";
            statusIcon = "fa-check-circle";
            statusText =
              "Actively hiring. Check their website or contact them for open positions.";
          } else if (hiringStatus === "limited") {
            statusColor = "text-yellow-600";
            statusIcon = "fa-clock";
            statusText =
              "Limited hiring for specific positions. Contact them for details.";
          } else if (hiringStatus === "not hiring") {
            statusColor = "text-red-600";
            statusIcon = "fa-times-circle";
            statusText = "Not currently hiring according to our information.";
          } else {
            statusColor = "text-gray-600";
            statusIcon = "fa-info-circle";
            statusText = `${company.hiringStatus} hiring status.`;
          }

          modalContent += `
      <div class="border-t border-gray-200 pt-4">
        <h4 class="text-md font-semibold text-gray-900 mb-2">Hiring Status</h4>
        <p class="flex items-center ${statusColor}">
          <i class="fas ${statusIcon} mr-2"></i> ${statusText}
        </p>
      </div>
    `;
        }

        // Add last updated info if available
        if (company.last_updated) {
          modalContent += `
      <div class="text-xs text-gray-500 mt-4 text-right">
        Information last updated: ${company.last_updated}
      </div>
    `;
        }

        modalContent += `</div>`;

        // Set the modal content
        modalBody.innerHTML = modalContent;
        modalContainer.classList.remove("hidden");
        document.body.classList.add("modal-active");
      }

      function closeModal() {
        modalContainer.classList.add("hidden");
        document.body.classList.remove("modal-active");
      }

      modalClose.addEventListener("click", closeModal);
      modalOk.addEventListener("click", closeModal);
      modalContainer.addEventListener("click", function (e) {
        if (e.target === modalContainer) {
          closeModal();
        }
      });

      // Modified displayCompanies function to handle pagination
      function displayCompanies(companies, append = false) {
        const container = document.getElementById("companies-container");
        const noResults = document.getElementById("no-results");
        const loadMoreContainer = document.getElementById(
          "load-more-container"
        );

        // If no append, clear the container
        if (!append) {
          container.innerHTML = "";
        }

        if (companies.length === 0 && !append) {
          container.classList.add("hidden");
          noResults.classList.remove("hidden");
          if (loadMoreContainer) loadMoreContainer.classList.add("hidden");
          return;
        }

        container.classList.remove("hidden");
        noResults.classList.add("hidden");

        // Calculate pagination indexes
        const startIndex = append ? (currentPage - 1) * itemsPerPage : 0;
        const endIndex = append ? startIndex + itemsPerPage : itemsPerPage;

        // Get the companies to display for this page
        const companiesToDisplay = companies.slice(startIndex, endIndex);

        // Check if we need to show the load more button
        const hasMore = endIndex < companies.length;
        if (loadMoreContainer) {
          if (hasMore) {
            loadMoreContainer.classList.remove("hidden");
          } else {
            loadMoreContainer.classList.add("hidden");
          }
        }

        companiesToDisplay.forEach((company) => {
          const card = document.createElement("div");
          card.className =
            "company-card bg-white rounded-lg shadow-md overflow-hidden";

          // Build business type badge
          let businessTypeHTML = "";
          if (company.businessType) {
            let typeColor = "";
            let typeIcon = "";

            if (company.businessType === "Service-based") {
              typeColor = "bg-blue-100 text-blue-800";
              typeIcon = "fa-hands-helping";
            } else if (company.businessType === "Product-based") {
              typeColor = "bg-green-100 text-green-800";
              typeIcon = "fa-box";
            } else if (company.businessType === "Hybrid") {
              typeColor = "bg-purple-100 text-purple-800";
              typeIcon = "fa-boxes";
            } else {
              typeColor = "bg-gray-100 text-gray-800";
              typeIcon = "fa-building";
            }

            businessTypeHTML = `
        <div class="mt-2">
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${typeColor}">
            <i class="fas ${typeIcon} mr-1"></i> ${company.businessType}
          </span>
        </div>
      `;
          }

          // Build locations HTML
          let locationsHTML = "";
          if (company.locations && company.locations.length > 0) {
            locationsHTML = `
        <div class="mt-3">
          <p class="text-sm text-gray-500 mb-2">Locations:</p>
          <div class="flex flex-wrap gap-2">
      `;

            company.locations.forEach((location) => {
              const hasMapLink =
                location.mapLink && location.mapLink.trim() !== "";
              const cityTag = hasMapLink
                ? `<a href="${location.mapLink}" target="_blank" rel="noopener noreferrer" class="location-tag inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-500 text-white">
              <i class="fas fa-map-marker-alt mr-1"></i> ${location.city}
            </a>`
                : `<span class="location-tag inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-200 text-gray-800">
              <i class="fas fa-map-pin mr-1"></i> ${location.city}
            </span>`;

              locationsHTML += cityTag;
            });

            locationsHTML += "</div></div>";
          }

          // Build tech stack HTML
          let techStackHTML = "";
          if (
            company.techStack &&
            Array.isArray(company.techStack) &&
            company.techStack.length > 0
          ) {
            techStackHTML = `
        <div class="mt-3">
          <p class="text-sm text-gray-500 mb-2">Tech Stack:</p>
          <div class="flex flex-wrap gap-1">
      `;

            company.techStack.forEach((tech) => {
              techStackHTML += `
          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800">
            <i class="fas fa-code mr-1"></i> ${tech}
          </span>
        `;
            });

            techStackHTML += "</div></div>";
          }

          // Build services HTML
          let servicesHTML = "";
          if (
            company.services &&
            Array.isArray(company.services) &&
            company.services.length > 0
          ) {
            servicesHTML = `
        <div class="mt-3">
          <p class="text-sm text-gray-500 mb-2">Services:</p>
          <div class="flex flex-wrap gap-1">
      `;

            company.services.forEach((service) => {
              servicesHTML += `
          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800">
            <i class="fas fa-cogs mr-1"></i> ${service}
          </span>
        `;
            });

            servicesHTML += "</div></div>";
          }

          // Build products HTML
          let productsHTML = "";
          if (
            company.products &&
            Array.isArray(company.products) &&
            company.products.length > 0
          ) {
            productsHTML = `
        <div class="mt-3">
          <p class="text-sm text-gray-500 mb-2">Products:</p>
          <div class="flex flex-wrap gap-1">
      `;

            company.products.forEach((product) => {
              productsHTML += `
          <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800">
            <i class="fas fa-box-open mr-1"></i> ${product}
          </span>
        `;
            });

            productsHTML += "</div></div>";
          }

          // Build hiring status HTML
          let hiringHTML = "";
          if (company.hiringStatus) {
            const hiringStatus = company.hiringStatus.toLowerCase();
            let statusColor = "";
            let statusIcon = "";

            if (hiringStatus === "active") {
              statusColor = "bg-green-100 text-green-800";
              statusIcon = "fa-check-circle";
            } else if (hiringStatus === "limited") {
              statusColor = "bg-yellow-100 text-yellow-800";
              statusIcon = "fa-clock";
            } else {
              statusColor = "bg-gray-100 text-gray-800";
              statusIcon = "fa-times-circle";
            }

            hiringHTML = `
        <div class="mt-3">
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor}">
            <i class="fas ${statusIcon} mr-1"></i> ${company.hiringStatus} Hiring
          </span>
        </div>
      `;
          }

          // Build social links HTML with proper brand colors
          let socialLinksHTML = "";
          if (company.socialLinks) {
            const links = [];

            if (company.socialLinks.linkedin) {
              links.push(`
          <a href="${company.socialLinks.linkedin}" target="_blank" rel="noopener noreferrer" class="text-[#0077b5] hover:opacity-80" title="LinkedIn">
            <i class="fab fa-linkedin fa-lg"></i>
          </a>
        `);
            }

            if (company.socialLinks.github) {
              links.push(`
          <a href="${company.socialLinks.github}" target="_blank" rel="noopener noreferrer" class="text-[#333333] hover:opacity-80" title="GitHub">
            <i class="fab fa-github fa-lg"></i>
          </a>
        `);
            }

            if (company.socialLinks.facebook) {
              links.push(`
          <a href="${company.socialLinks.facebook}" target="_blank" rel="noopener noreferrer" class="text-[#1877f2] hover:opacity-80" title="Facebook">
            <i class="fab fa-facebook-square fa-lg"></i>
          </a>
        `);
            }

            if (company.socialLinks.instagram) {
              links.push(`
          <a href="${company.socialLinks.instagram}" target="_blank" rel="noopener noreferrer" class="text-[#e1306c] hover:opacity-80" title="Instagram">
            <i class="fab fa-instagram fa-lg"></i>
          </a>
        `);
            }

            if (company.socialLinks.careers) {
              links.push(`
          <a href="${company.socialLinks.careers}" target="_blank" rel="noopener noreferrer" class="text-[#28a745] hover:opacity-80" title="Careers">
            <i class="fas fa-briefcase fa-lg"></i>
          </a>
        `);
            }

            if (links.length > 0) {
              socialLinksHTML = `
          <div class="mt-3 flex space-x-3">
            ${links.join("")}
          </div>
        `;
            }
          }

          // Info button for description
          const infoButton = company.description
            ? `<button class="info-button text-blue-600 hover:text-blue-800 ml-2" data-company-name="${
                company.name
              }" data-company-description="${company.description.replace(
                /"/g,
                "&quot;"
              )}">
          <i class="fas fa-info-circle"></i>
        </button>`
            : "";

          // Company name with website link if available
          const companyNameHTML = company.website
            ? `<a href="${company.website}" target="_blank" rel="noopener noreferrer" class="text-gray-900 hover:text-green-600 transition-colors flex items-center">
           ${company.name}
           <i class="fas fa-external-link-alt text-xs ml-2 text-green-600"></i>
         </a>`
            : company.name;

          // Last updated info
          const lastUpdatedHTML = company.last_updated
            ? `<p class="text-xs text-gray-400 mt-1">Last updated: ${company.last_updated}</p>`
            : "";

          card.innerHTML = `
      <div class="p-6">
        <div class="flex items-start justify-between">
          <h3 class="text-lg font-semibold text-gray-900 mb-2">${companyNameHTML}</h3>
          ${infoButton}
        </div>
        ${lastUpdatedHTML}
        ${businessTypeHTML}
        <div class="text-sm text-gray-600 space-y-2">
          <p class="flex items-start">
            <i class="fas fa-envelope w-5 text-gray-400 mt-1"></i>
            <span class="ml-2">${company.email}</span>
          </p>
        </div>
        ${hiringHTML}
        ${locationsHTML}
        ${techStackHTML}
        ${servicesHTML}
        ${productsHTML}
        ${socialLinksHTML}
      </div>
    `;

          // Add event listener for info button if description exists
          if (company.description) {
            card
              .querySelector(".info-button")
              .addEventListener("click", function () {
                const companyName = this.getAttribute("data-company-name");
                const companyDescription = this.getAttribute(
                  "data-company-description"
                );
                openModal(
                  companyName,
                  `<p class="text-gray-700">${companyDescription}</p>`
                );
              });
          }

          container.appendChild(card);
        });
      }

      // Function to load more companies
      function loadMoreCompanies() {
        if (isLoading) return;

        isLoading = true;
        document.getElementById("load-more-btn").innerHTML =
          '<i class="fas fa-spinner fa-spin mr-2"></i> Loading...';

        // Simulate a small delay to show loading state
        setTimeout(() => {
          currentPage++;
          displayCompanies(filteredCompanies, true);
          updateResultsCount();
          isLoading = false;
          document.getElementById("load-more-btn").innerHTML =
            'Load More <i class="fas fa-chevron-down ml-2"></i>';
        }, 300);
      }

      // Update results count with pagination info
      function updateResultsCount() {
        const count = document.getElementById("results-count");
        const currentlyShowing = Math.min(
          currentPage * itemsPerPage,
          filteredCompanies.length
        );

        if (filteredCompanies.length === allCompanies.length) {
          count.textContent = `Showing ${currentlyShowing} of ${allCompanies.length} companies`;
        } else {
          count.textContent = `Showing ${currentlyShowing} of ${filteredCompanies.length} filtered companies (from ${allCompanies.length} total)`;
        }
      }

      // Modify filterCompanies function to handle pagination
      function filterCompanies() {
        const searchTerm = document
          .getElementById("search-input")
          .value.toLowerCase();
        const selectedCity = document.getElementById("city-filter").value;

        // console.log(
        //   "Filtering - Search Term:",
        //   searchTerm,
        //   "Selected City:",
        //   selectedCity
        // );

        filteredCompanies = allCompanies.filter((company) => {
          // Check if company name or email matches search term
          const matchesSearch =
            company.name.toLowerCase().includes(searchTerm) ||
            company.email.toLowerCase().includes(searchTerm);

          // Check if any location matches selected city
          let matchesCity = true;
          if (selectedCity) {
            matchesCity =
              company.locations &&
              company.locations.some(
                (location) => location.city === selectedCity
              );
          }

          return matchesSearch && matchesCity;
        });

        // console.log("Filtered results:", filteredCompanies.length);

        // Reset pagination when filter changes
        currentPage = 1;

        // Display the first page
        displayCompanies(filteredCompanies);
        updateResultsCount();
      }

      function populateCityFilter() {
        const cityFilter = document.getElementById("city-filter");

        // Get all cities from all companies (including multiple locations)
        let allCities = [];
        allCompanies.forEach((company) => {
          if (company.locations) {
            company.locations.forEach((location) => {
              allCities.push(location.city);
            });
          }
        });

        // Create a unique, sorted list of cities
        const uniqueCities = [...new Set(allCities)].sort();

        // Major cities to prioritize
        const majorCities = [
          "Karachi",
          "Lahore",
          "Islamabad",
          "Rawalpindi",
          "Faisalabad",
          "Peshawar",
          "Multan",
        ];

        // Filter to only show cities we have data for
        const citiesInData = majorCities.filter((city) =>
          uniqueCities.includes(city)
        );

        // Add options to the dropdown
        cityFilter.innerHTML = '<option value="">All Cities</option>';
        citiesInData.forEach((city) => {
          const option = document.createElement("option");
          option.value = city;
          option.textContent = city;
          cityFilter.appendChild(option);
        });
      }

      // Fetch and process data with pagination
      async function fetchData() {
        try {
          // Load saved preferences first
          loadSavedPreferences();

          const response = await fetch("data.json");
          if (!response.ok) {
            throw new Error("Failed to fetch data");
          }
          allCompanies = await response.json();
          filteredCompanies = [...allCompanies];

          // Log data to console for debugging
          // console.log("Data loaded:", allCompanies.length, "companies");

          // Populate cities dropdown
          populateCityFilter();

          // Reset pagination
          currentPage = 1;

          // Display companies (first page only)
          displayCompanies(allCompanies);

          // Hide loading, show companies
          document.getElementById("loading").classList.add("hidden");
          document
            .getElementById("companies-container")
            .classList.remove("hidden");
          updateResultsCount();

          // Make sure Load More button is visible if needed
          if (allCompanies.length > itemsPerPage) {
            document
              .getElementById("load-more-container")
              .classList.remove("hidden");
          } else {
            document
              .getElementById("load-more-container")
              .classList.add("hidden");
          }
        } catch (error) {
          // console.error("Error:", error);
          document.getElementById("loading").innerHTML = `
            <div class="text-red-500">
              <i class="fas fa-exclamation-circle fa-3x"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-700 mt-4">Failed to load data</h3>
            <p class="text-gray-500 mt-2">Please try again later or check the data.json file.</p>
          `;
        }
      }

      // Event listeners
      document
        .getElementById("search-input")
        .addEventListener("input", filterCompanies);
      document
        .getElementById("city-filter")
        .addEventListener("change", filterCompanies);
      document
        .getElementById("load-more-btn")
        .addEventListener("click", loadMoreCompanies);
      document
        .getElementById("items-per-page")
        .addEventListener("change", changeItemsPerPage);

      // Load data when page loads
      window.addEventListener("DOMContentLoaded", fetchData);
    </script>
  </body>
</html>
