<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Developers Directory - Find Software Houses in Pakistan</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    />
    <style>
      .company-card {
        transition: transform 0.2s, box-shadow 0.2s;
      }
      .company-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }
      .hero-pattern {
        background-color: #075e54;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 100 100'%3E%3Cg fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.12'%3E%3Cpath opacity='.5' d='M96 95h4v1h-4v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4h-9v4h-1v-4H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15v-9H0v-1h15V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h9V0h1v15h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9h4v1h-4v9zm-1 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm9-10v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-10 0v-9h-9v9h9zm-9-10h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9zm10 0h9v-9h-9v9z'/%3E%3Cpath d='M6 5V0H5v5H0v1h5v94h1V6h94V5H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      }
      .modal {
        transition: opacity 0.25s ease;
      }
      .modal-active {
        overflow-y: visible !important;
      }
      .location-tag {
        transition: all 0.2s;
      }
      .location-tag:hover {
        background-color: #047857;
      }

      /* Fix for search text visibility */
      #search-input::placeholder {
        color: #9ca3af;
      }

      #search-input {
        color: #111827;
      }

      #city-filter {
        color: #111827; /* Dark text color for better visibility */
        background-color: #ffffff; /* White background */
      }

      #city-filter option {
        color: #111827; /* Ensure dropdown options are visible */
        background-color: #ffffff; /* White background for options */
      }

      /* Fix for dropdown focus states */
      #city-filter:focus {
        border-color: #10b981; /* Green border when focused (matches the site theme) */
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.2); /* Subtle green glow */
        outline: none;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-md">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16">
          <div class="flex">
            <div class="flex-shrink-0 flex items-center">
              <span class="text-2xl font-bold text-green-600"
                >Developers Directory</span
              >
            </div>
            <div class="hidden sm:ml-6 sm:flex sm:space-x-8">
              <a
                href="index.html"
                class="border-green-500 text-gray-900 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
              >
                Directory
              </a>
              <a
                href="about.html"
                class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
              >
                About Us
              </a>
              <a
                href="https://github.com/Hassan1305/Developers-Directory"
                target="_blank"
                class="border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700 inline-flex items-center px-1 pt-1 border-b-2 text-sm font-medium"
              >
                <i class="fab fa-github mr-1"></i> GitHub
              </a>
            </div>
          </div>
          <div class="-mr-2 flex items-center sm:hidden">
            <button
              id="mobile-menu-button"
              class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-green-500"
            >
              <span class="sr-only">Open main menu</span>
              <svg
                class="h-6 w-6"
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Mobile menu, show/hide based on menu state -->
      <div id="mobile-menu" class="sm:hidden hidden">
        <div class="pt-2 pb-3 space-y-1">
          <a
            href="index.html"
            class="bg-green-50 border-green-500 text-green-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium"
          >
            Directory
          </a>
          <a
            href="about.html"
            class="border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium"
          >
            About Us
          </a>
          <a
            href="https://github.com/Hassan1305/Developers-Directory"
            target="_blank"
            class="border-transparent text-gray-500 hover:bg-gray-50 hover:border-gray-300 hover:text-gray-700 block pl-3 pr-4 py-2 border-l-4 text-base font-medium"
          >
            <i class="fab fa-github mr-1"></i> GitHub
          </a>
        </div>
      </div>
    </nav>

    <!-- Hero section -->
    <div class="hero-pattern text-white">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-20">
        <h1 class="text-3xl md:text-4xl font-bold mb-4">
          Find Software Houses in Pakistan
        </h1>
        <p class="text-xl opacity-90 mb-8 max-w-3xl">
          The most comprehensive open-source directory of software companies in
          Pakistan for job seekers, freelancers, and students.
        </p>

        <!-- Search and filter -->
        <div class="bg-white p-4 rounded-lg shadow-md max-w-4xl">
          <div class="md:flex space-y-4 md:space-y-0 md:space-x-4">
            <div class="relative md:flex-1">
              <div
                class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"
              >
                <i class="fas fa-search text-gray-400"></i>
              </div>
              <input
                id="search-input"
                type="text"
                class="block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-green-500 focus:border-green-500 sm:text-sm"
                placeholder="Search by company name or email..."
              />
            </div>
            <div class="md:w-1/4">
              <select
                id="city-filter"
                class="block w-full pl-3 pr-10 py-2 text-base border border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md"
              >
                <option value="">All Cities</option>
                <!-- Cities will be populated from data.json -->
              </select>
            </div>
          </div>
          <div class="mt-2 text-right">
            <span id="results-count" class="text-sm text-gray-600"
              >Showing all companies</span
            >
          </div>
        </div>
      </div>
    </div>

    <!-- Company directory -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div id="loading" class="text-center py-10">
        <div
          class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"
        ></div>
        <p class="mt-2 text-gray-600">Loading software houses...</p>
      </div>

      <div
        id="companies-container"
        class="hidden grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
      >
        <!-- Companies will be populated here from data.json -->
      </div>

      <div id="no-results" class="hidden text-center py-10">
        <div class="text-gray-400 mb-4">
          <i class="fas fa-search fa-3x"></i>
        </div>
        <h3 class="text-xl font-semibold text-gray-700">No companies found</h3>
        <p class="text-gray-500 mt-2">Try adjusting your search or filter</p>
      </div>
    </div>

    <!-- Company Description Modal -->
    <div
      id="modal-container"
      class="hidden fixed inset-0 z-50 flex items-center justify-center"
    >
      <div class="modal-overlay absolute inset-0 bg-black opacity-50"></div>
      <div
        class="modal-container bg-white w-11/12 md:max-w-md mx-auto rounded shadow-lg z-50 overflow-y-auto max-h-full"
      >
        <!-- Modal Content -->
        <div class="modal-content py-4 text-left px-6">
          <!-- Modal Header -->
          <div class="flex justify-between items-center pb-3">
            <p id="modal-title" class="text-xl font-bold text-gray-900"></p>
            <button
              id="modal-close"
              class="modal-close cursor-pointer z-50 text-gray-500 hover:text-gray-800"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
          <!-- Modal Body -->
          <div id="modal-body" class="text-gray-600"></div>
          <!-- Modal Footer -->
          <div class="pt-4 flex justify-end">
            <button
              id="modal-ok"
              class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500"
            >
              Close
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-8 mt-8">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="md:flex md:justify-between">
          <div class="mb-6 md:mb-0">
            <h2 class="text-xl font-bold">Developers Directory</h2>
            <p class="mt-2 text-gray-300 text-sm">
              An open-source directory of software houses in Pakistan.
            </p>
          </div>
          <div>
            <h3 class="text-sm font-semibold uppercase tracking-wider">
              Links
            </h3>
            <div class="mt-4 space-y-2">
              <a href="index.html" class="text-gray-300 hover:text-white block"
                >Home</a
              >
              <a href="about.html" class="text-gray-300 hover:text-white block"
                >About Us</a
              >
            </div>
          </div>
        </div>
        <div
          class="mt-8 border-t border-gray-700 pt-6 flex flex-col md:flex-row justify-between"
        >
          <p class="text-gray-300 text-sm">
            &copy; 2025 Developers Directory. All rights reserved.
          </p>
          <p class="text-gray-300 text-sm mt-2 md:mt-0">
            Made with <span class="text-red-500">❤</span> for the Pakistani dev
            community
          </p>
        </div>
      </div>
    </footer>

    <script>
      // Mobile menu toggle
      document
        .getElementById("mobile-menu-button")
        .addEventListener("click", function () {
          const menu = document.getElementById("mobile-menu");
          menu.classList.toggle("hidden");
        });

      // Modal functionality
      const modalContainer = document.getElementById("modal-container");
      const modalTitle = document.getElementById("modal-title");
      const modalBody = document.getElementById("modal-body");
      const modalClose = document.getElementById("modal-close");
      const modalOk = document.getElementById("modal-ok");

      function openModal(title, content) {
        modalTitle.textContent = title;
        modalBody.innerHTML = content;
        modalContainer.classList.remove("hidden");
        document.body.classList.add("modal-active");
      }

      function closeModal() {
        modalContainer.classList.add("hidden");
        document.body.classList.remove("modal-active");
      }

      modalClose.addEventListener("click", closeModal);
      modalOk.addEventListener("click", closeModal);
      modalContainer.addEventListener("click", function (e) {
        if (e.target === modalContainer) {
          closeModal();
        }
      });

      // Fetch and process data
      let allCompanies = [];
      let filteredCompanies = [];

      async function fetchData() {
        try {
          const response = await fetch("data.json");
          if (!response.ok) {
            throw new Error("Failed to fetch data");
          }
          allCompanies = await response.json();
          filteredCompanies = [...allCompanies];

          // Log data to console for debugging
          console.log("Data loaded:", allCompanies);

          // Populate cities dropdown
          populateCityFilter();

          // Display companies
          displayCompanies(allCompanies);

          // Hide loading, show companies
          document.getElementById("loading").classList.add("hidden");
          document
            .getElementById("companies-container")
            .classList.remove("hidden");
          updateResultsCount();
        } catch (error) {
          console.error("Error:", error);
          document.getElementById("loading").innerHTML = `
                    <div class="text-red-500">
                        <i class="fas fa-exclamation-circle fa-3x"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-700 mt-4">Failed to load data</h3>
                    <p class="text-gray-500 mt-2">Please try again later or check the data.json file.</p>
                `;
        }
      }

      function populateCityFilter() {
        const cityFilter = document.getElementById("city-filter");

        // Get all cities from all companies (including multiple locations)
        let allCities = [];
        allCompanies.forEach((company) => {
          if (company.locations) {
            company.locations.forEach((location) => {
              allCities.push(location.city);
            });
          }
        });

        // Create a unique, sorted list of cities
        const uniqueCities = [...new Set(allCities)].sort();

        // Major cities to prioritize
        const majorCities = [
          "Karachi",
          "Lahore",
          "Islamabad",
          "Rawalpindi",
          "Faisalabad",
          "Peshawar",
          "Multan",
        ];

        // Filter to only show cities we have data for
        const citiesInData = majorCities.filter((city) =>
          uniqueCities.includes(city)
        );

        // Add options to the dropdown
        cityFilter.innerHTML = '<option value="">All Cities</option>';
        citiesInData.forEach((city) => {
          const option = document.createElement("option");
          option.value = city;
          option.textContent = city;
          cityFilter.appendChild(option);
        });
      }

      function displayCompanies(companies) {
        const container = document.getElementById("companies-container");
        const noResults = document.getElementById("no-results");

        container.innerHTML = "";

        if (companies.length === 0) {
          container.classList.add("hidden");
          noResults.classList.remove("hidden");
          return;
        }

        container.classList.remove("hidden");
        noResults.classList.add("hidden");

        companies.forEach((company) => {
          const card = document.createElement("div");
          card.className =
            "company-card bg-white rounded-lg shadow-md overflow-hidden";

          // Build locations HTML
          let locationsHTML = "";
          if (company.locations && company.locations.length > 0) {
            locationsHTML = `
                        <div class="mt-3">
                            <p class="text-sm text-gray-500 mb-2">Locations:</p>
                            <div class="flex flex-wrap gap-2">
                    `;

            company.locations.forEach((location) => {
              const hasMapLink =
                location.mapLink && location.mapLink.trim() !== "";
              const cityTag = hasMapLink
                ? `<a href="${location.mapLink}" target="_blank" rel="noopener noreferrer" class="location-tag inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-500 text-white">
                                <i class="fas fa-map-marker-alt mr-1"></i> ${location.city}
                            </a>`
                : `<span class="location-tag inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-200 text-gray-800">
                                <i class="fas fa-map-pin mr-1"></i> ${location.city}
                            </span>`;

              locationsHTML += cityTag;
            });

            locationsHTML += "</div></div>";
          }

          // Info button for description
          const infoButton = company.description
            ? `<button class="info-button text-blue-600 hover:text-blue-800 ml-2" data-company-name="${
                company.name
              }" data-company-description="${company.description.replace(
                /"/g,
                "&quot;"
              )}">
                        <i class="fas fa-info-circle"></i>
                      </button>`
            : "";

          card.innerHTML = `
                    <div class="p-6">
                        <div class="flex items-start justify-between">
                            <h3 class="text-lg font-semibold text-gray-900 mb-2">${company.name}</h3>
                            ${infoButton}
                        </div>
                        <div class="text-sm text-gray-600 space-y-2">
                            <p class="flex items-start">
                                <i class="fas fa-envelope w-5 text-gray-400 mt-1"></i>
                                <span class="ml-2">${company.email}</span>
                            </p>
                        </div>
                        ${locationsHTML}
                    </div>
                `;

          // Add event listener for info button if description exists
          if (company.description) {
            card
              .querySelector(".info-button")
              .addEventListener("click", function () {
                const companyName = this.getAttribute("data-company-name");
                const companyDescription = this.getAttribute(
                  "data-company-description"
                );
                openModal(
                  companyName,
                  `<p class="text-gray-700">${companyDescription}</p>`
                );
              });
          }

          container.appendChild(card);
        });
      }

      function updateResultsCount() {
        const count = document.getElementById("results-count");
        if (filteredCompanies.length === allCompanies.length) {
          count.textContent = `Showing all ${allCompanies.length} companies`;
        } else {
          count.textContent = `Showing ${filteredCompanies.length} of ${allCompanies.length} companies`;
        }
      }

      // Filter companies based on search input and city selection
      function filterCompanies() {
        const searchTerm = document
          .getElementById("search-input")
          .value.toLowerCase();
        const selectedCity = document.getElementById("city-filter").value;

        console.log(
          "Filtering - Search Term:",
          searchTerm,
          "Selected City:",
          selectedCity
        );

        filteredCompanies = allCompanies.filter((company) => {
          // Check if company name or email matches search term
          const matchesSearch =
            company.name.toLowerCase().includes(searchTerm) ||
            company.email.toLowerCase().includes(searchTerm);

          // Check if any location matches selected city
          let matchesCity = true;
          if (selectedCity) {
            matchesCity =
              company.locations &&
              company.locations.some(
                (location) => location.city === selectedCity
              );
          }

          return matchesSearch && matchesCity;
        });

        console.log("Filtered results:", filteredCompanies.length);

        displayCompanies(filteredCompanies);
        updateResultsCount();
      }

      // Event listeners
      document
        .getElementById("search-input")
        .addEventListener("input", filterCompanies);
      document
        .getElementById("city-filter")
        .addEventListener("change", filterCompanies);

      // Load data when page loads
      window.addEventListener("DOMContentLoaded", fetchData);
    </script>
  </body>
</html>
